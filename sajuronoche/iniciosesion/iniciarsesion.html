<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="../css/img/logo-login.png">
    <title>Sajuro</title>
    <link rel="stylesheet" href="../css/inicio.css">
    <link rel="stylesheet" href="../iniciosesion/css/sesion.css">
    
    <script>
        (function() {
            function verificarSesion() {
                // Cambiado a localStorage
                const usuarioId = localStorage.getItem('usuarioId');
                const nombreUsuario = localStorage.getItem('nombreUsuario');
                
                console.log('Verificando sesión...');
                console.log('Usuario ID:', usuarioId);
                console.log('Nombre Usuario:', nombreUsuario);
                
                if (usuarioId || nombreUsuario) {
                    console.log('Sesión activa detectada. Iniciando redirección...');
                    try {
                        const redirectURL = 'http://localhost/sajuro/sajuronoche/menu/amigos-suge.html';
                        console.log('Redirigiendo a:', redirectURL);
                        window.location.href = redirectURL;
                        return true;
                    } catch (error) {
                        console.error('Error durante la redirección:', error);
                    }
                } else {
                    console.log('No hay sesión activa, mostrando formulario de login');
                    return false;
                }
            }

            // Verificar sesión inmediatamente
            verificarSesion();

            // Verificar nuevamente cuando el DOM esté listo
            document.addEventListener('DOMContentLoaded', verificarSesion);

            // Y una última vez cuando todos los recursos estén cargados
            window.addEventListener('load', function() {
                if (!verificarSesion()) {
                    console.log('Carga completa - No hay sesión activa');
                }
            });
        })();
    </script>
</head>
<body>
    <div class="contenedor">
        <div class="tarjeta">
            <div class="conten">
                <div class="logo-login">
                    <a href="../index.html">
                        <img src="../css/img/logo-login.png" class="img-logoLogin" width="150px">
                    </a>                    
                </div>
                <div class="conten-sesion">
                    <form id="iniciosesion" method="POST">
                        <div class="input-container">
                            <input type="text" id="usuario" name="usuario" required>
                            <label>Usuario</label>
                            <svg xmlns="http://www.w3.org/2000/svg" width="28" height="25" fill="currentColor" class="user" viewBox="0 0 16 16">
                                <path d="M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6"/>
                            </svg>                    
                        </div>
                        <div class="input-container">
                            <input type="password" class="contrasena" id="contrasena" name="contrasena" required>
                            <label>Contraseña</label>
                            <svg xmlns="http://www.w3.org/2000/svg" class="pass" width="30" height="28" viewBox="0 0 24 24">
                                <rect x="6" y="12" width="12" height="8" rx="2" fill="currentColor" stroke="currentColor" stroke-width="2"/>
                                <path d="M12 2C9.8 2 8 3.8 8 6v4h8V6c0-2.2-1.8-4-4-4z" fill="currentColor" stroke="none"/>
                                <rect x="11" y="14" width="2" height="4" rx="1" fill="currentColor"/>
                            </svg>
                        </div>
                        <div class="olvidar">
                            <a href="../restablecer/correo-olvide.html"><div class="olvide">olvide mi contraseña</div></a>
                        </div>
                        <br>
                        <button class="login-button" type="submit">Iniciar sesión</button>
                    </form>
                    <div id="login-message"></div>
                </div>
            </div>
        </div>
    </div>
    <script src="js/login.js"></script>
</body>
</html>